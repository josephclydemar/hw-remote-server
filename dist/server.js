(()=>{"use strict";var e={681:function(e,t,r){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(422),s=o(r(471));t.default={getAuthorizedUsers:async function(e,t){try{const e=await s.default.find({}).sort({createdAt:-1});return void t.status(200).json(e)}catch(e){if(!(e instanceof Error))throw new Error("Error: GET /authorized_users");console.error(e.message),t.status(500).json({message:"Server Error!!",error:!0})}},getOneAuthorizedUser:async function(e,t){try{const r=await s.default.findOne({_id:e.params.id}).sort({createdAt:-1});return void t.status(200).json(r)}catch(e){if(!(e instanceof Error))throw new Error("Error: GET /authorized_users");console.error(e.message),t.status(500).json({message:"Server Error!!",error:!0})}},insertOneAuthorizedUser:async function(e,t){try{if(null==await s.default.findOne({name:e.body.name}).exec()){const r=await s.default.create({profileImage:e.body.profileImage,name:e.body.name});return t.status(200).json(r),void n.MyEvent.emit("added_new_authorized_user_event")}t.status(409).json({message:"Authorized Users conflict of Names",conflict:!0})}catch(e){if(!(e instanceof Error))throw new Error("Error: POST /authorized_users");console.error(e.message),t.status(500).json({message:"Server Error!!",error:!0})}}}},876:function(e,t,r){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(422),s=o(r(86));t.default={getDayRecords:async function(e,t){try{const e=await s.default.find({}).sort({createdAt:-1});return void t.status(200).json(e)}catch(e){if(!(e instanceof Error))throw new Error("Error: GET /day_records");console.error(e.message),t.status(500).json({message:"Server Error!!",error:!0})}},getCurrentDayRecord:async function(e,t){try{const e=await s.default.findOne({}).sort({createdAt:-1});t.status(200).json(e)}catch(e){e instanceof Error&&(console.error(e.message),t.status(500).json({message:"Server Error!!",error:!0}))}},insertOneDayRecord:async function(e,t){try{const r=await s.default.create({detections:e.body.detections});return t.status(200).json(r),void n.MyEvent.emit("added_new_day_record_event")}catch(e){if(!(e instanceof Error))throw new Error("Error: POST /day_records");console.error(e.message),t.status(500).json({message:"Server Error!!",error:!0})}}}},40:function(e,t,r){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=r(422),s=o(r(934));t.default={getDetections:async function(e,t){try{const e=await s.default.find({}).sort({createdAt:-1});return void t.status(200).json(e)}catch(e){if(!(e instanceof Error))throw new Error("Error: GET /detections");console.error(e.message),t.status(500).json({message:"Server Error!!",error:!0})}},insertOneDetection:async function(e,t){try{if(null==await s.default.findOne({recordedVideo:e.body.recordedVideo}).exec()){const r=await s.default.create({recordedVideo:e.body.recordedVideo});return t.status(200).json(r),void n.MyEvent.emit("added_new_detection_event")}t.status(409).json({message:"Detections conflict of recordedVideos",conflict:!0})}catch(e){if(!(e instanceof Error))throw new Error("Error: POST /detections");console.error(e.message),t.status(500).json({message:"Server Error!!",error:!0})}}}},422:function(e,t,r){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MyEvent=void 0;const n=new(o(r(261)).default);t.MyEvent=n},709:function(e,t,r){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.deleteOldestDayRecord=t.insertCurrentDayRecord=void 0;const n=o(r(86)),s=r(422);t.insertCurrentDayRecord=async function(){await n.default.create({detections:[]}),s.MyEvent.emit("added_new_day_record_event")},t.deleteOldestDayRecord=async function(){const e=await n.default.findOne({}).sort({createdAt:-1});await n.default.deleteOne({_id:e?._id}),s.MyEvent.emit("deleted_oldest_day_record_event")}},95:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.logEvent=void 0;const o=r(172),n=r(903);t.logEvent=function(e,t){const r=`[${e}] ->  ${(0,o.format)(new Date,"yyyy-MM-dd HH:mm:ss")}   ${(0,n.v4)()}\t${t}`;console.log(r)}},471:function(e,t,r){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(37)),s=new n.default.Schema({profileImage:{type:String,required:!0},name:{type:String,required:!0}},{timestamps:!0});t.default=n.default.model("authorized_users",s)},86:function(e,t,r){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(37)),s=new n.default.Schema({detections:{type:[n.default.SchemaTypes.ObjectId],required:!0}},{timestamps:!0});t.default=n.default.model("day_records",s)},934:function(e,t,r){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(37)),s=new n.default.Schema({recordedVideo:{type:String,required:!0}},{timestamps:!0});t.default=n.default.model("detections",s)},763:function(e,t,r){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(252)),s=o(r(681)),a=n.default.Router();a.route("/authorized_users").get(s.default.getAuthorizedUsers).post(s.default.insertOneAuthorizedUser),a.route("/authorized_users/:id").get(s.default.getOneAuthorizedUser),t.default=a},30:function(e,t,r){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(252)),s=o(r(876)),a=n.default.Router();a.route("/current_day_record").get(s.default.getCurrentDayRecord),t.default=a},830:function(e,t,r){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(252)),s=o(r(876)),a=n.default.Router();a.route("/day_records").get(s.default.getDayRecords).post(s.default.insertOneDayRecord),t.default=a},130:function(e,t,r){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(252)),s=o(r(40)),a=n.default.Router();a.route("/detections").get(s.default.getDetections).post(s.default.insertOneDetection),t.default=a},950:function(e,t,r){var o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const n=o(r(577)),s=o(r(703)),a=o(r(818)),u=o(r(37)),d=o(r(252)),i=(r(437),r(422),r(95)),c=o(r(763)),f=o(r(130)),l=o(r(830)),_=o(r(30)),v=r(709);a.default.config(),process.env.PORT;const y="production",p=process.env.DATABASE_URI||"",h=(0,d.default)();h.use((function(e,t,r){(0,i.logEvent)(y,`${e.method}\t${e.headers.origin}\t${e.url}`),r()})),h.use((0,n.default)()),h.use(d.default.urlencoded({extended:!1})),h.use(d.default.json()),h.use("/api/v1",c.default),h.use("/api/v1",f.default),h.use("/api/v1",l.default),h.use("/api/v1",_.default),h.all("*",(function(e,t){t.status(404).send("Invalid path.")})),s.default.schedule("0 0 0 * * *",(function(){(0,v.insertCurrentDayRecord)(),(0,v.deleteOldestDayRecord)()})),u.default.connect(p).then((function(){(0,i.logEvent)(y,`${p.split("+")[0]} Connected to database`)})).catch((function(e){console.log(e.message)}))},577:e=>{e.exports=require("cors")},172:e=>{e.exports=require("date-fns")},818:e=>{e.exports=require("dotenv")},261:e=>{e.exports=require("events")},252:e=>{e.exports=require("express")},37:e=>{e.exports=require("mongoose")},703:e=>{e.exports=require("node-cron")},437:e=>{e.exports=require("socket.io")},903:e=>{e.exports=require("uuid")}},t={},r=function r(o){var n=t[o];if(void 0!==n)return n.exports;var s=t[o]={exports:{}};return e[o].call(s.exports,s,s.exports,r),s.exports}(950),o=exports;for(var n in r)o[n]=r[n];r.__esModule&&Object.defineProperty(o,"__esModule",{value:!0})})();